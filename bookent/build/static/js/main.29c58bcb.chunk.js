(this.webpackJsonpbookent=this.webpackJsonpbookent||[]).push([[3],{2:function(e,t,s){e.exports={themelight:"style_themelight__3ufPy",themedark:"style_themedark__2SNYZ",logoDiv:"style_logoDiv__3amyv",addDiv:"style_addDiv__2PCi4",big:"style_big__3Owfa",small:"style_small__qmWgm",navbar:"style_navbar__16IKj",infosDiv:"style_infosDiv__2IoVb",hamDiv:"style_hamDiv__3nUm-",ham:"style_ham__20-ko",hamcheck:"style_hamcheck__2U8VU",menu:"style_menu__2fKkl",categs:"style_categs__3cQG9",navi:"style_navi__3hi_N",dark:"style_dark__3L-6W",toggleButtonCover:"style_toggleButtonCover__17mc-",buttonCover:"style_buttonCover__lCZZn",knobs:"style_knobs__fvkKc",layer:"style_layer__vHqMB",button:"style_button__16zfJ",r:"style_r__3MPxe",b2:"style_b2__37QhZ",checkbox:"style_checkbox__3rxx6",button3:"style_button3__3WL8S",profile:"style_profile__2giG4",main:"style_main__3kioI",welcome:"style_welcome__2fHWa",halfs:"style_halfs__3QtMl",half1:"style_half1__C36Vn",phrases:"style_phrases__30yNu",half2:"style_half2__1Y1if",routes:"style_routes__321WP",router:"style_router__1q8Ke",books:"style_books__SoYlw",bookslist:"style_bookslist__2fwwE",book:"style_book__3A3ah",bookdetails:"style_bookdetails__1ATMg",bookcover:"style_bookcover__1Zhsk",bookname:"style_bookname__Iyedv",love:"style_love__3xFwf",bookgen:"style_bookgen__3r-4l",bookdesc:"style_bookdesc__2b1lW",edit:"style_edit__2vVYw",editBtn:"style_editBtn__3NX10",delBtn:"style_delBtn__1D5HW",imgsticky:"style_imgsticky__1Jll8",slide:"style_slide__1cNIh"}},25:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return l}));var c=s(10),a=s(1),n=s(0),o=Object(a.createContext)(),l=function(e){var t,s=Object(a.useState)(["Jordan","Palestine","Iraq","Ksa","egypt","Lebanon"]),l=Object(c.a)(s,2),r=l[0],i=(l[1],Object(a.useState)(["islamic","story","food","culuture","science","education","other"])),_=Object(c.a)(i,2),u=_[0],b=(_[1],Object(a.useState)(localStorage.getItem("token")||null)),d=Object(c.a)(b,2),j=d[0],h=d[1],m=Object(a.useState)(localStorage.getItem("user")||null),O=Object(c.a)(m,2),g=O[0],v=O[1],y=Object(a.useState)(),x=Object(c.a)(y,2),f=x[0],p=x[1],k=Object(a.useState)(!1),N=Object(c.a)(k,2),S=N[0],I=N[1],w=Object(a.useCallback)((function(e,t,s){h({token:e}),v(t);var c=s||new Date((new Date).getTime()+864e5);p(c),localStorage.setItem("token",JSON.stringify({token:e,expirationTime:c.toString()})),localStorage.setItem("user",JSON.stringify(t))}),[]),B=Object(a.useCallback)((function(){h(null),p(null),localStorage.removeItem("token"),localStorage.removeItem("user")}),[]);return Object(a.useLayoutEffect)((function(){var e=JSON.parse(localStorage.getItem("token")),t=JSON.parse(localStorage.getItem("user"));e&&t&&e.token&&new Date(e.expirationTime)>new Date&&w(e.token,t,new Date(e.expirationTime))}),[w]),Object(a.useLayoutEffect)((function(){if(j&&f){var e=f.getTime()-(new Date).getTime();t=setTimeout(B,e)}else clearTimeout(t)}),[j,B,f]),Object(a.useLayoutEffect)((function(){localStorage.setItem("user",JSON.stringify(g))}),[g]),Object(n.jsx)(o.Provider,{value:{isLogged:!!j,login:w,logout:B,user:g,setuser:v,countriesList:r,categoryList:u,connected:S,setconnected:I},children:e.children})}},3:function(e,t,s){e.exports={themelight:"style_themelight__-uui5",themedark:"style_themedark__aEN7a",messengerSmall:"style_messengerSmall__1hu_5",messenger:"style_messenger__2yM2l",chatMenu:"style_chatMenu__3lpux",chatMenuInput:"style_chatMenuInput__1fPhi",chatBox:"style_chatBox__1InA2",chatBoxWrapper:"style_chatBoxWrapper__ZULJA",chatBoxTop:"style_chatBoxTop__2BC_a",chatBoxBottom:"style_chatBoxBottom__dZ4oe",chatMessageInput:"style_chatMessageInput__2JrUJ",chatSubmitButton:"style_chatSubmitButton__1-Ymx",chatOnline:"style_chatOnline__2nVoJ",chatMenuWrapper:"style_chatMenuWrapper__39DKK",chatOnlineWrapper:"style_chatOnlineWrapper__4yl8p",noConversationText:"style_noConversationText__1TJot",chatHeader:"style_chatHeader__3c7nK",conversation:"style_conversation__2Gifv",conversationImg:"style_conversationImg__2w7Bl",conversationName:"style_conversationName__1xpXq",message:"style_message__GtVb1",messageOwn:"style_messageOwn__RliBt",messageTop:"style_messageTop__w2zda",messageImg:"style_messageImg__XtEAY",messageText:"style_messageText__3gfD3",messageBottom:"style_messageBottom__12ciK"}},38:function(e,t,s){e.exports={themelight:"style_themelight__I2sSz",themedark:"style_themedark__AFUnQ",logoDiv:"style_logoDiv__1njC0",addDiv:"style_addDiv__1nDu6",big:"style_big__2ewRC",small:"style_small__5SsEp",navbar:"style_navbar__1vng-",infosDiv:"style_infosDiv__2xqdA",hamDiv:"style_hamDiv__3uT4D",ham:"style_ham__3U0LR",hamcheck:"style_hamcheck__Vt8S6",menu:"style_menu__3uhST",categs:"style_categs__2FHof",categorys:"style_categorys__1JPAq",dropdown:"style_dropdown__2qj8n",countriesSelect:"style_countriesSelect__1kh3n",navi:"style_navi__2FbXx",dark:"style_dark__1BZJ2",toggleButtonCover:"style_toggleButtonCover__1BAEa",buttonCover:"style_buttonCover__1ttuG",knobs:"style_knobs__2-d_R",layer:"style_layer__1vfzS",button:"style_button__3_9yO",r:"style_r__3c28x",b2:"style_b2__xULH-",checkbox:"style_checkbox__OEcLe",button3:"style_button3__3LGdR",profile:"style_profile__1qqiT",main:"style_main__3ZPNl",welcome:"style_welcome__20lyl",halfs:"style_halfs__1w8v6",half1:"style_half1__4mxRN",phrases:"style_phrases__QmOd5",half2:"style_half2__zA4t7",routes:"style_routes__vnunl",router:"style_router__2CGWP",types:"style_types__hU0Ar",typesround:"style_typesround__1tYFr",books:"style_books__3jpOT",search:"style_search__32yd1",filters:"style_filters__3wTuR",bookslist:"style_bookslist__1KFw_",book:"style_book__4foD3",bookdetails:"style_bookdetails__1JVJi",bookname:"style_bookname__mCQo3",love:"style_love__3T3U6",bookgen:"style_bookgen__2ucGp",bookdesc:"style_bookdesc__3YfzY",loader:"style_loader__2XDzx",clones2:"style_clones2__sAosZ",cl2:"style_cl2__HQwpl",countries:"style_countries__ez3rf",addsticky:"style_addsticky__39IbQ",imgsticky:"style_imgsticky__1Ojwl",logo2:"style_logo2__2bA13",slide:"style_slide__1mhu9",countriesModal:"style_countriesModal__2EaKz",country:"style_country__2FAK0",copyDiv:"style_copyDiv__1JAag"}},43:function(e,t,s){"use strict";s.r(t);var c=s(38),a=s.n(c),n=s(13),o=s(0);t.default=function(e){return Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)("footer",{children:[Object(o.jsxs)("div",{className:a.a.copyDiv,children:[Object(o.jsx)("span",{children:"@ 2021 copyright for Bookent Team"}),Object(o.jsx)("a",{href:"mailto:bookenteto10@gmail.com",children:Object(o.jsx)("span",{children:"Email us"})})]}),Object(o.jsxs)("ul",{children:[Object(o.jsx)(n.b,{to:"/home",children:Object(o.jsx)("li",{children:"Home"})}),Object(o.jsx)(n.b,{to:"/about",children:Object(o.jsx)("li",{children:"About"})}),Object(o.jsx)("li",{onClick:e.logout,children:"Log out"})]}),Object(o.jsx)("div",{className:a.a.logo2,children:Object(o.jsx)(n.b,{to:"/home",children:Object(o.jsx)("img",{src:"/assets/bookent logo black.svg",alt:"bookent logo"})})})]})})}},44:function(e,t,s){"use strict";s.r(t);var c=s(1),a=s(2),n=s.n(a),o=s(25),l=s(13),r=s(0);t.default=function(e){var t=Object(c.useRef)(),s=Object(c.useContext)(o.a),a=s.logout,i=s.user;return Object(c.useLayoutEffect)((function(){var e=localStorage.getItem("theme");document.documentElement.className="themelight"===e.toString()?n.a.themelight:n.a.themedark}),[]),Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)("div",{className:n.a.navbar,children:[Object(r.jsx)("div",{className:n.a.logoDiv,children:Object(r.jsxs)(l.b,{to:"/home",children:[Object(r.jsx)("img",{src:"/assets/bookent logo black.svg",className:n.a.big,loading:"lazy",alt:"bookent logo"}),Object(r.jsx)("img",{src:"/assets/logo small.svg",className:n.a.small,loading:"lazy",alt:"bookent logo"})]})}),Object(r.jsx)("div",{className:n.a.addDiv,children:Object(r.jsx)(l.b,{to:"/addBook",children:Object(r.jsx)("img",{src:"/assets/add.svg",alt:"add book"})})}),Object(r.jsxs)("div",{className:n.a.infosDiv,children:[Object(r.jsxs)("div",{className:n.a.menu,ref:t,children:[Object(r.jsxs)("div",{className:n.a.categs,children:[Object(r.jsx)("div",{className:n.a.navi,children:Object(r.jsx)(l.b,{to:"/home",children:Object(r.jsx)("div",{children:Object(r.jsx)("p",{children:"Home"})})})}),Object(r.jsx)("div",{className:n.a.navi,children:Object(r.jsx)(l.b,{to:"/chat",children:Object(r.jsx)("div",{children:Object(r.jsx)("p",{children:"Messages"})})})}),Object(r.jsx)("div",{className:n.a.navi,children:Object(r.jsx)("div",{onClick:a,children:Object(r.jsx)("p",{children:"Log out"})})})]}),Object(r.jsx)("div",{className:n.a.dark,children:Object(r.jsx)("div",{className:n.a.toggleButtonCover,children:Object(r.jsx)("div",{className:n.a.buttonCover,children:Object(r.jsxs)("div",{className:"".concat(n.a.button,"  ").concat(n.a.r),id:n.a.button3,children:[Object(r.jsx)("input",{type:"checkbox",className:n.a.checkbox,onChange:function(e){e.target.checked?(document.documentElement.className=n.a.themedark,localStorage.setItem("theme","themedark")):(document.documentElement.className=n.a.themelight,localStorage.setItem("theme","themelight"))},defaultChecked:"themedark"===localStorage.getItem("theme")}),Object(r.jsx)("div",{className:n.a.knobs}),Object(r.jsx)("div",{className:n.a.layer})]})})})}),Object(r.jsx)(l.b,{to:"/profile",children:Object(r.jsxs)("div",{className:n.a.profile,children:[Object(r.jsx)("img",{src:i&&i.profileImg&&"".concat("http://localhost:3001","/usersImages/").concat(i.profileImg)||"/assets/user.svg",alt:"profile"}),Object(r.jsx)("span",{children:i&&i.username})]})})]}),Object(r.jsxs)("div",{className:n.a.hamDiv,children:[Object(r.jsx)("input",{type:"checkbox",id:n.a.hamcheck,onChange:function(e){e.target.checked?t.current.style="display:flex":t.current.style="display:none"}}),Object(r.jsx)("div",{id:n.a.ham})]})]})]})})}},56:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var c=s(63),a=s(3),n=s.n(a),o=s(0);function l(e){var t=e.message,s=e.own,a=e.owner;return Object(o.jsxs)("div",{className:s?n.a.messageOwn:n.a.message,children:[Object(o.jsxs)("div",{className:n.a.messageTop,children:[Object(o.jsx)("img",{className:n.a.messageImg,src:a.profileImg&&"".concat("http://localhost:3001","/usersImages/").concat(a.profileImg)||"/assets/user.svg",alt:a.username}),Object(o.jsx)("p",{className:n.a.messageText,children:t.text})]}),Object(o.jsx)("div",{className:n.a.messageBottom,children:Object(c.a)(t.createdAt)})]})}},68:function(e,t,s){},97:function(e,t,s){"use strict";s.r(t);var c=s(45),a=s.n(c),n=(s(68),s(1)),o=s(13),l=s(4),r=s(25),i=s(0),_=function(e){var t=e.children;return Object(n.useContext)(r.a).isLogged||!!localStorage.getItem("token")?t:Object(i.jsx)(l.a,{exact:!0,to:"/"})},u=s(19),b=s.n(u),d=s(27),j=s(41),h=s(10),m=s(26),O=s.n(m),g=s(44),v=s(43),y=s(56),x=s(3),f=s.n(x);function p(e){var t=e.conversation,s=e.currentUser,c=Object(n.useState)(null),a=Object(h.a)(c,2),o=a[0],l=a[1];return Object(n.useEffect)((function(){var e=t.members.find((function(e){return e!==s._id})),c=function(){var t=Object(d.a)(b.a.mark((function t(){var s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O()("".concat("http://localhost:3001","/getOwner/").concat(e));case 3:s=t.sent,l(s.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();c()}),[s,t]),Object(i.jsxs)("div",{className:f.a.conversation,children:[Object(i.jsx)("img",{className:f.a.conversationImg,src:(null===o||void 0===o?void 0:o.profileImg)?"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:3001",REACT_APP_CHAT_API:"//localhost:8900"}).API_URL,"/usersImages/").concat(o.profileImg):"/assets/user.svg",alt:"user"}),Object(i.jsx)("span",{className:f.a.conversationName,children:null===o||void 0===o?void 0:o.username})]})}var k=s(57);var N=function(){var e=Object(n.useContext)(r.a),t=e.user,s=e.connected,c=e.setconnected,a="";t&&(a=t._id);var o=Object(n.useState)([]),l=Object(h.a)(o,2),_=l[0],u=l[1],m=Object(n.useState)(null),x=Object(h.a)(m,2),N=x[0],S=x[1],I=Object(n.useState)([]),w=Object(h.a)(I,2),B=w[0],C=w[1],D=Object(n.useState)(""),T=Object(h.a)(D,2),E=T[0],A=T[1],M=Object(n.useState)(null),L=Object(h.a)(M,2),z=L[0],J=L[1],P=Object(n.useState)({}),W=Object(h.a)(P,2),R=W[0],U=W[1],H=Object(n.useRef)(),K=Object(n.useRef)();Object(n.useEffect)((function(){var e=localStorage.getItem("theme");document.documentElement.className="themelight"===e.toString()?f.a.themelight:f.a.themedark}),[]),Object(n.useEffect)((function(){s&&window.location.reload()}),[]),Object(n.useEffect)((function(){H.current=Object(k.a)("ws:".concat("//localhost:8900"),{transports:["websocket"],upgrade:!1}),c(!0),H.current.on("getMessage",(function(e){J({sender:e.senderId,text:e.text,createdAt:e.createdAt})}))}),[]),Object(n.useEffect)((function(){z&&(null===N||void 0===N?void 0:N.members.includes(z.sender))&&C((function(e){return[].concat(Object(j.a)(e),[z])}))}),[z,N]),Object(n.useEffect)((function(){H.current.emit("addUser",a)}),[t]),Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat("http://localhost:3001","/getConv/").concat(a));case 3:t=e.sent,u(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[a]),Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat("http://localhost:3001","/getMsg/").concat(null===N||void 0===N?void 0:N._id));case 3:t=e.sent,C(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[N]);var F=function(){var e=Object(d.a)(b.a.mark((function e(t){var s,c,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!E){e.next=16;break}return s={sender:a,text:E,conversationId:N._id,createdAt:Date.now()},c=N.members.find((function(e){return e!==a})),H.current.emit("sendMessage",{senderId:a,receiverId:c,text:E}),e.prev=5,e.next=8,O.a.post("".concat("http://localhost:3001","/addMsg/"),{message:s});case 8:n=e.sent,C([].concat(Object(j.a)(B),[n.data])),A(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){if(N){var e=N.members.filter((function(e){return e!=a})),t=function(){var t=Object(d.a)(b.a.mark((function t(){var s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O()("".concat("http://localhost:3001","/getOwner/").concat(e));case 3:s=t.sent,U(s.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t()}}),[N]),Object(n.useEffect)((function(){var e;null===(e=K.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[B]),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(g.default,{}),Object(i.jsxs)("div",{className:f.a.messenger,children:[Object(i.jsx)("div",{className:f.a.chatMenu,children:Object(i.jsxs)("div",{className:f.a.chatMenuWrapper,children:[Object(i.jsx)("p",{className:f.a.messageBottom,children:"Chats"}),Object(i.jsx)("hr",{}),_.map((function(e){return Object(i.jsx)("div",{onClick:function(){return S(e)},children:Object(i.jsx)(p,{conversation:e,currentUser:t})})}))]})}),Object(i.jsx)("div",{className:f.a.chatBox,children:Object(i.jsxs)("div",{className:f.a.chatBoxWrapper,children:[(null===R||void 0===R?void 0:R.username)&&Object(i.jsxs)("div",{className:f.a.chatHeader,children:[Object(i.jsx)("img",{src:(null===R||void 0===R?void 0:R.profileImg)?"".concat("http://localhost:3001","/usersImages/").concat(R.profileImg):"/assets/user.svg",alt:"user"}),Object(i.jsx)("span",{children:null===R||void 0===R?void 0:R.username})]}),N?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("div",{className:f.a.chatBoxTop,children:B.map((function(e){return Object(i.jsx)("div",{ref:K,children:Object(i.jsx)(y.a,{message:e,own:e.sender===a,owner:e.sender===a?t:R})})}))}),Object(i.jsxs)("div",{className:f.a.chatBoxBottom,children:[Object(i.jsx)("textarea",{className:f.a.chatMessageInput,placeholder:"write something...",onChange:function(e){return A(e.target.value)},value:E}),Object(i.jsx)("button",{className:f.a.chatSubmitButton,onClick:F,children:Object(i.jsx)("img",{src:"/assets/send.svg",alt:"send"})})]})]}):Object(i.jsx)("span",{className:f.a.noConversationText,children:"Open a conversation to start a chat."})]})})]}),Object(i.jsx)(v.default,{})]})},S=Object(n.lazy)((function(){return s.e(8).then(s.bind(null,145))})),I=Object(n.lazy)((function(){return s.e(14).then(s.bind(null,134))})),w=Object(n.lazy)((function(){return s.e(6).then(s.bind(null,146))})),B=Object(n.lazy)((function(){return s.e(20).then(s.bind(null,135))})),C=Object(n.lazy)((function(){return s.e(23).then(s.bind(null,136))})),D=Object(n.lazy)((function(){return s.e(9).then(s.bind(null,137))})),T=Object(n.lazy)((function(){return s.e(7).then(s.bind(null,138))})),E=Object(n.lazy)((function(){return s.e(10).then(s.bind(null,139))})),A=Object(n.lazy)((function(){return s.e(19).then(s.bind(null,140))}));var M=function(){return Object(i.jsx)(r.b,{children:Object(i.jsx)(o.a,{children:Object(i.jsx)(n.Suspense,{fallback:Object(i.jsx)("div",{id:"loader",children:Object(i.jsx)("div",{className:"clones2"})}),children:Object(i.jsxs)(l.d,{children:[Object(i.jsx)(l.a,{exact:!0,from:"/",to:"/login"}),Object(i.jsx)(l.b,{exact:!0,path:"/home",children:Object(i.jsx)(_,{children:Object(i.jsx)(I,{})})}),Object(i.jsx)(l.b,{exact:!0,path:"/login",children:Object(i.jsx)(S,{})}),Object(i.jsx)(l.b,{path:"/Book/:id",children:Object(i.jsx)(_,{children:Object(i.jsx)(w,{})})}),Object(i.jsx)(l.b,{path:"/yourBooks",children:Object(i.jsx)(_,{children:Object(i.jsx)(C,{})})}),Object(i.jsx)(l.b,{path:"/favorites",children:Object(i.jsx)(_,{children:Object(i.jsx)(B,{})})}),Object(i.jsx)(l.b,{path:"/profile",children:Object(i.jsx)(_,{children:Object(i.jsx)(T,{})})}),Object(i.jsx)(l.b,{path:"/addBook",children:Object(i.jsx)(_,{children:Object(i.jsx)(D,{})})}),Object(i.jsx)(l.b,{path:"/editBook/:id",children:Object(i.jsx)(_,{children:Object(i.jsx)(E,{})})}),Object(i.jsx)(l.b,{path:"/about",children:Object(i.jsx)(A,{})}),Object(i.jsx)(l.b,{path:"/chat",children:Object(i.jsx)(_,{children:Object(i.jsx)(N,{})})})]})})})})};a.a.render(Object(i.jsx)(M,{}),document.getElementById("root"))}},[[97,4,5]]]);
//# sourceMappingURL=main.29c58bcb.chunk.js.map